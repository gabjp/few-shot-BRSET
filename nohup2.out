Namespace(p_learning_rate=0.001, p_epochs=15, p_batch_size=16, p_l2=0, model='resnet50.a3_in1k', save_path='./experiments/test2', e_learning_rate=0.001, e_l2=0, e_runs=50)
Loading model...
Model Parameters: 23524424
Class weights: tensor([1.3530, 4.3296, 4.9118, 6.9583, 0.3798, 4.1162, 0.3204, 1.4576])
[1/15] - Training loss: 1.7792857136742655 - Training accuracy: 30.047048759623614
[1/15] - Validation loss: 1.5587746211976716 - Validation accuracy: 55.19230769230769
[1/15] - Epoch took 62.972867012023926 seconds
[2/15] - Training loss: 1.2953126597323108 - Training accuracy: 51.06928999144568
[2/15] - Validation loss: 1.309344439795523 - Validation accuracy: 59.80769230769231
[2/15] - Epoch took 54.78649377822876 seconds
[3/15] - Training loss: 0.9802398243251514 - Training accuracy: 59.623609923011124
[3/15] - Validation loss: 1.4251871407032013 - Validation accuracy: 52.11538461538462
[3/15] - Epoch took 54.0394184589386 seconds
[4/15] - Training loss: 0.7691492244550393 - Training accuracy: 66.10350727117195
[4/15] - Validation loss: 1.484642693490693 - Validation accuracy: 49.61538461538461
[4/15] - Epoch took 49.95386552810669 seconds
[5/15] - Training loss: 0.5997149520664898 - Training accuracy: 71.57827202737383
[5/15] - Validation loss: 1.5060823695226149 - Validation accuracy: 65.0
[5/15] - Epoch took 49.66311073303223 seconds
[6/15] - Training loss: 0.47316746525593584 - Training accuracy: 76.04790419161677
[6/15] - Validation loss: 1.44893382173596 - Validation accuracy: 60.192307692307686
[6/15] - Epoch took 53.08908128738403 seconds
[7/15] - Training loss: 0.2983137405010214 - Training accuracy: 82.18562874251496
[7/15] - Validation loss: 1.680734095248309 - Validation accuracy: 62.5
[7/15] - Epoch took 50.843884229660034 seconds
[8/15] - Training loss: 0.19036430053718056 - Training accuracy: 88.38751069289992
[8/15] - Validation loss: 2.015236846876867 - Validation accuracy: 70.76923076923077
[8/15] - Epoch took 49.23767423629761 seconds
[9/15] - Training loss: 0.14240617738280179 - Training accuracy: 90.59024807527801
[9/15] - Validation loss: 1.975276898705598 - Validation accuracy: 71.92307692307692
[9/15] - Epoch took 54.6630756855011 seconds
[10/15] - Training loss: 0.14569393970205768 - Training accuracy: 91.89478186484175
[10/15] - Validation loss: 1.8205489398855152 - Validation accuracy: 64.23076923076924
[10/15] - Epoch took 47.99713850021362 seconds
[11/15] - Training loss: 0.2143694372790462 - Training accuracy: 88.5372112917023
[11/15] - Validation loss: 1.8914529292872457 - Validation accuracy: 56.730769230769226
[11/15] - Epoch took 48.323678970336914 seconds
[12/15] - Training loss: 0.12278699095173398 - Training accuracy: 92.87852865697177
[12/15] - Validation loss: 2.0289918690016777 - Validation accuracy: 70.76923076923077
[12/15] - Epoch took 48.43696355819702 seconds
[13/15] - Training loss: 0.06712747176031585 - Training accuracy: 96.17194183062446
[13/15] - Validation loss: 2.36001880421783 - Validation accuracy: 65.0
[13/15] - Epoch took 58.211376905441284 seconds
[14/15] - Training loss: 0.18201461123976437 - Training accuracy: 89.49957228400342
[14/15] - Validation loss: 2.264613494728551 - Validation accuracy: 64.8076923076923
[14/15] - Epoch took 67.34017634391785 seconds
[15/15] - Training loss: 0.0210506745432138 - Training accuracy: 98.78100940975193
[15/15] - Validation loss: 2.526257970116355 - Validation accuracy: 67.11538461538461
[15/15] - Epoch took 73.60285234451294 seconds
Starting 2-way-5-shot - 52 epochs
[1/50] - 2-way-5-shot - Acc: 100.0 - 11.981773614883423 s - ['vascular_occlusion', 'hemorrhage']
[2/50] - 2-way-5-shot - Acc: 100.0 - 7.3610920906066895 s - ['hemorrhage', 'vascular_occlusion']
[3/50] - 2-way-5-shot - Acc: 100.0 - 6.687057971954346 s - ['vascular_occlusion', 'hemorrhage']
[4/50] - 2-way-5-shot - Acc: 50.0 - 7.596101760864258 s - ['healthy', 'vascular_occlusion']
[5/50] - 2-way-5-shot - Acc: 50.0 - 6.60009765625 s - ['nevus', 'healthy']
[6/50] - 2-way-5-shot - Acc: 50.0 - 9.944517850875854 s - ['vascular_occlusion', 'healthy']
[7/50] - 2-way-5-shot - Acc: 100.0 - 7.478214979171753 s - ['vascular_occlusion', 'healthy']
[8/50] - 2-way-5-shot - Acc: 100.0 - 6.625638246536255 s - ['vascular_occlusion', 'nevus']
[9/50] - 2-way-5-shot - Acc: 100.0 - 7.111093997955322 s - ['vascular_occlusion', 'nevus']
[10/50] - 2-way-5-shot - Acc: 100.0 - 7.526332139968872 s - ['nevus', 'hemorrhage']
[11/50] - 2-way-5-shot - Acc: 50.0 - 6.589475870132446 s - ['nevus', 'vascular_occlusion']
[12/50] - 2-way-5-shot - Acc: 100.0 - 6.634938478469849 s - ['healthy', 'hemorrhage']
[13/50] - 2-way-5-shot - Acc: 100.0 - 6.546444416046143 s - ['hemorrhage', 'nevus']
[14/50] - 2-way-5-shot - Acc: 100.0 - 7.931952953338623 s - ['hemorrhage', 'vascular_occlusion']
[15/50] - 2-way-5-shot - Acc: 100.0 - 7.49676775932312 s - ['hemorrhage', 'vascular_occlusion']
[16/50] - 2-way-5-shot - Acc: 50.0 - 6.828381299972534 s - ['hemorrhage', 'healthy']
[17/50] - 2-way-5-shot - Acc: 50.0 - 8.15360713005066 s - ['hemorrhage', 'healthy']
[18/50] - 2-way-5-shot - Acc: 100.0 - 6.774447202682495 s - ['healthy', 'vascular_occlusion']
[19/50] - 2-way-5-shot - Acc: 0.0 - 10.006214380264282 s - ['healthy', 'nevus']
[20/50] - 2-way-5-shot - Acc: 50.0 - 6.676586389541626 s - ['nevus', 'hemorrhage']
[21/50] - 2-way-5-shot - Acc: 100.0 - 9.884471416473389 s - ['vascular_occlusion', 'healthy']
[22/50] - 2-way-5-shot - Acc: 50.0 - 6.776474714279175 s - ['nevus', 'healthy']
[23/50] - 2-way-5-shot - Acc: 50.0 - 8.960530281066895 s - ['healthy', 'vascular_occlusion']
[24/50] - 2-way-5-shot - Acc: 0.0 - 11.040865421295166 s - ['healthy', 'hemorrhage']
[25/50] - 2-way-5-shot - Acc: 50.0 - 11.276105403900146 s - ['nevus', 'vascular_occlusion']
[26/50] - 2-way-5-shot - Acc: 50.0 - 8.415570259094238 s - ['vascular_occlusion', 'nevus']
[27/50] - 2-way-5-shot - Acc: 50.0 - 8.579846382141113 s - ['nevus', 'healthy']
[28/50] - 2-way-5-shot - Acc: 100.0 - 9.666489601135254 s - ['vascular_occlusion', 'hemorrhage']
[29/50] - 2-way-5-shot - Acc: 50.0 - 10.213574886322021 s - ['healthy', 'vascular_occlusion']
[30/50] - 2-way-5-shot - Acc: 0.0 - 10.979187726974487 s - ['nevus', 'healthy']
[31/50] - 2-way-5-shot - Acc: 100.0 - 8.638456344604492 s - ['healthy', 'vascular_occlusion']
[32/50] - 2-way-5-shot - Acc: 100.0 - 7.386571884155273 s - ['hemorrhage', 'healthy']
[33/50] - 2-way-5-shot - Acc: 0.0 - 10.728549003601074 s - ['hemorrhage', 'healthy']
[34/50] - 2-way-5-shot - Acc: 50.0 - 10.908454895019531 s - ['nevus', 'vascular_occlusion']
[35/50] - 2-way-5-shot - Acc: 50.0 - 9.0257568359375 s - ['vascular_occlusion', 'nevus']
[36/50] - 2-way-5-shot - Acc: 100.0 - 12.988946914672852 s - ['healthy', 'hemorrhage']
[37/50] - 2-way-5-shot - Acc: 0.0 - 10.501064777374268 s - ['hemorrhage', 'vascular_occlusion']
[38/50] - 2-way-5-shot - Acc: 100.0 - 11.484610080718994 s - ['healthy', 'vascular_occlusion']
[39/50] - 2-way-5-shot - Acc: 100.0 - 7.28126859664917 s - ['hemorrhage', 'healthy']
[40/50] - 2-way-5-shot - Acc: 50.0 - 10.172104597091675 s - ['nevus', 'vascular_occlusion']
[41/50] - 2-way-5-shot - Acc: 50.0 - 11.859559535980225 s - ['nevus', 'healthy']
[42/50] - 2-way-5-shot - Acc: 50.0 - 11.362038612365723 s - ['hemorrhage', 'vascular_occlusion']
[43/50] - 2-way-5-shot - Acc: 0.0 - 7.675267457962036 s - ['healthy', 'hemorrhage']
[44/50] - 2-way-5-shot - Acc: 50.0 - 7.245760917663574 s - ['healthy', 'hemorrhage']
[45/50] - 2-way-5-shot - Acc: 100.0 - 8.834108591079712 s - ['nevus', 'hemorrhage']
[46/50] - 2-way-5-shot - Acc: 50.0 - 9.236095905303955 s - ['nevus', 'hemorrhage']
[47/50] - 2-way-5-shot - Acc: 100.0 - 10.490854263305664 s - ['vascular_occlusion', 'hemorrhage']
[48/50] - 2-way-5-shot - Acc: 50.0 - 10.213850259780884 s - ['vascular_occlusion', 'healthy']
[49/50] - 2-way-5-shot - Acc: 100.0 - 10.493219137191772 s - ['healthy', 'hemorrhage']
[50/50] - 2-way-5-shot - Acc: 0.0 - 9.972944736480713 s - ['nevus', 'hemorrhage']
2-way-5-shot Average Acc: 65.0
Starting 2-way-10-shot - 26 epochs
[1/50] - 2-way-10-shot - Acc: 50.0 - 11.225965976715088 s - ['healthy', 'vascular_occlusion']
[2/50] - 2-way-10-shot - Acc: 100.0 - 8.440844297409058 s - ['hemorrhage', 'vascular_occlusion']
[3/50] - 2-way-10-shot - Acc: 100.0 - 10.039878845214844 s - ['nevus', 'vascular_occlusion']
[4/50] - 2-way-10-shot - Acc: 0.0 - 6.415985107421875 s - ['healthy', 'hemorrhage']
[5/50] - 2-way-10-shot - Acc: 100.0 - 8.68912649154663 s - ['nevus', 'healthy']
[6/50] - 2-way-10-shot - Acc: 0.0 - 11.910479068756104 s - ['healthy', 'nevus']
[7/50] - 2-way-10-shot - Acc: 100.0 - 10.380250453948975 s - ['healthy', 'vascular_occlusion']
[8/50] - 2-way-10-shot - Acc: 100.0 - 8.640067100524902 s - ['vascular_occlusion', 'nevus']
[9/50] - 2-way-10-shot - Acc: 50.0 - 8.395755529403687 s - ['healthy', 'hemorrhage']
[10/50] - 2-way-10-shot - Acc: 100.0 - 9.588868856430054 s - ['nevus', 'vascular_occlusion']
[11/50] - 2-way-10-shot - Acc: 50.0 - 11.064753770828247 s - ['healthy', 'nevus']
[12/50] - 2-way-10-shot - Acc: 100.0 - 11.668470859527588 s - ['nevus', 'healthy']
[13/50] - 2-way-10-shot - Acc: 0.0 - 10.41690707206726 s - ['hemorrhage', 'nevus']
[14/50] - 2-way-10-shot - Acc: 0.0 - 10.985029220581055 s - ['nevus', 'healthy']
[15/50] - 2-way-10-shot - Acc: 50.0 - 11.801042556762695 s - ['nevus', 'hemorrhage']
[16/50] - 2-way-10-shot - Acc: 50.0 - 9.31256365776062 s - ['vascular_occlusion', 'healthy']
[17/50] - 2-way-10-shot - Acc: 50.0 - 9.902177333831787 s - ['healthy', 'nevus']
[18/50] - 2-way-10-shot - Acc: 100.0 - 9.178853273391724 s - ['healthy', 'vascular_occlusion']
[19/50] - 2-way-10-shot - Acc: 100.0 - 10.705734968185425 s - ['nevus', 'healthy']
[20/50] - 2-way-10-shot - Acc: 0.0 - 8.37056565284729 s - ['healthy', 'hemorrhage']
[21/50] - 2-way-10-shot - Acc: 100.0 - 11.15618371963501 s - ['hemorrhage', 'vascular_occlusion']
[22/50] - 2-way-10-shot - Acc: 50.0 - 6.316730976104736 s - ['hemorrhage', 'nevus']
[23/50] - 2-way-10-shot - Acc: 100.0 - 7.365050315856934 s - ['hemorrhage', 'healthy']
[24/50] - 2-way-10-shot - Acc: 100.0 - 10.12702226638794 s - ['healthy', 'hemorrhage']
[25/50] - 2-way-10-shot - Acc: 0.0 - 11.493700504302979 s - ['hemorrhage', 'vascular_occlusion']
[26/50] - 2-way-10-shot - Acc: 100.0 - 10.903510808944702 s - ['nevus', 'vascular_occlusion']
[27/50] - 2-way-10-shot - Acc: 100.0 - 10.987295389175415 s - ['hemorrhage', 'vascular_occlusion']
[28/50] - 2-way-10-shot - Acc: 0.0 - 11.931602239608765 s - ['healthy', 'hemorrhage']
[29/50] - 2-way-10-shot - Acc: 100.0 - 10.983951330184937 s - ['nevus', 'hemorrhage']
[30/50] - 2-way-10-shot - Acc: 0.0 - 8.977378606796265 s - ['hemorrhage', 'healthy']
[31/50] - 2-way-10-shot - Acc: 50.0 - 9.790523529052734 s - ['nevus', 'hemorrhage']
[32/50] - 2-way-10-shot - Acc: 0.0 - 10.36729097366333 s - ['nevus', 'hemorrhage']
[33/50] - 2-way-10-shot - Acc: 100.0 - 13.195606470108032 s - ['nevus', 'vascular_occlusion']
[34/50] - 2-way-10-shot - Acc: 100.0 - 9.769172668457031 s - ['hemorrhage', 'healthy']
[35/50] - 2-way-10-shot - Acc: 50.0 - 9.933807373046875 s - ['hemorrhage', 'vascular_occlusion']
[36/50] - 2-way-10-shot - Acc: 100.0 - 11.082459211349487 s - ['healthy', 'nevus']
[37/50] - 2-way-10-shot - Acc: 0.0 - 9.500212907791138 s - ['nevus', 'healthy']
[38/50] - 2-way-10-shot - Acc: 50.0 - 8.403780937194824 s - ['healthy', 'vascular_occlusion']
[39/50] - 2-way-10-shot - Acc: 50.0 - 9.963543176651001 s - ['vascular_occlusion', 'nevus']
[40/50] - 2-way-10-shot - Acc: 50.0 - 10.9683358669281 s - ['vascular_occlusion', 'healthy']
[41/50] - 2-way-10-shot - Acc: 100.0 - 8.428110361099243 s - ['vascular_occlusion', 'nevus']
[42/50] - 2-way-10-shot - Acc: 50.0 - 10.458717584609985 s - ['hemorrhage', 'nevus']
[43/50] - 2-way-10-shot - Acc: 0.0 - 11.316251039505005 s - ['nevus', 'healthy']
[44/50] - 2-way-10-shot - Acc: 0.0 - 11.773744106292725 s - ['hemorrhage', 'nevus']
[45/50] - 2-way-10-shot - Acc: 50.0 - 11.837770223617554 s - ['healthy', 'nevus']
[46/50] - 2-way-10-shot - Acc: 50.0 - 10.695194721221924 s - ['healthy', 'vascular_occlusion']
[47/50] - 2-way-10-shot - Acc: 100.0 - 9.081203937530518 s - ['healthy', 'hemorrhage']
[48/50] - 2-way-10-shot - Acc: 50.0 - 10.816923141479492 s - ['healthy', 'vascular_occlusion']
[49/50] - 2-way-10-shot - Acc: 0.0 - 13.071398496627808 s - ['nevus', 'hemorrhage']
[50/50] - 2-way-10-shot - Acc: 100.0 - 10.490350008010864 s - ['vascular_occlusion', 'healthy']
2-way-10-shot Average Acc: 58.0
Starting 2-way-20-shot - 13 epochs
[1/50] - 2-way-20-shot - Acc: 0.0 - 11.080171823501587 s - ['healthy', 'nevus']
[2/50] - 2-way-20-shot - Acc: 100.0 - 9.980700254440308 s - ['vascular_occlusion', 'nevus']
[3/50] - 2-way-20-shot - Acc: 100.0 - 11.714736461639404 s - ['hemorrhage', 'vascular_occlusion']
[4/50] - 2-way-20-shot - Acc: 50.0 - 11.130464792251587 s - ['nevus', 'healthy']
[5/50] - 2-way-20-shot - Acc: 50.0 - 11.13364028930664 s - ['vascular_occlusion', 'nevus']
[6/50] - 2-way-20-shot - Acc: 50.0 - 7.762516260147095 s - ['nevus', 'healthy']
[7/50] - 2-way-20-shot - Acc: 100.0 - 11.946013927459717 s - ['nevus', 'healthy']
[8/50] - 2-way-20-shot - Acc: 100.0 - 8.622024059295654 s - ['vascular_occlusion', 'hemorrhage']
